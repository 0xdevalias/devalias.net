<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <!-- [[! Document Settings ]] -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <!-- [[! Page Meta ]] -->
    <title>Plesk - Adding wget/tar/gzip/chmod/php/curl/clear to a chrooted SSH</title>
    <meta name="description" content="/dev/alias – Hack. Dev. Transcend. - My intention is for this to be a place where I post anything that interests my geeky mind. I may not update it often, and you may not find it that interesting.. You've been forewarned.
">

    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Webmention -->
    <link rel="webmention" href="https://webmention.io/devalias.net/webmention">
<link rel="pingback" href="https://webmention.io/devalias.net/xmlrpc">

    <meta property="webmention:redirected_from" content="http://devalias.tumblr.com/post/61566531090/plesk-adding-wget-tar-gzip-chmod-php-curl-clear-to-a-chr,/post/61566531090/plesk-adding-wget-tar-gzip-chmod-php-curl-clear-to-a-chr">

    <link rel="shortcut icon" href="/assets/images/authors/devalias.png">

    <!-- [[! Styles'n'Scripts ]] -->
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic%7COpen+Sans:700,400">
          
    <link rel="stylesheet" type="text/css" href="/assets/css/screen.css">
    <link rel="stylesheet" type="text/css" href="/assets/css/syntax.css">

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">

    <link rel="stylesheet" type="text/css" href="/assets/css/custom.css">
    
    <!-- [[! Ghost outputs important style and meta data with this tag ]] -->
      <link rel="canonical" href="/">
  <meta name="referrer" content="origin">
  <!-- <link rel="next" href="/page2/" /> -->

  <meta property="og:site_name" content="">
  <meta property="og:type" content="website">
  <meta property="og:title" content="">
  <meta property="og:description" content="My intention is for this to be a place where I post anything that interests my geeky mind. I may not update it often, and you may not find it that interesting.. You've been forewarned.
">
  <meta property="og:url" content="/">
  <meta property="og:image" content="/assets/images/cover4.jpg">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="/dev/alias – Hack. Dev. Transcend.">
  <meta name="twitter:description" content="My intention is for this to be a place where I post anything that interests my geeky mind. I may not update it often, and you may not find it that interesting.. You've been forewarned.
">
  <meta name="twitter:url" content="/">
  <meta name="twitter:image:src" content="/assets/images/cover4.jpg">

  <script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Website",
    "publisher": "devalias.net}",
    "url": "/",
    "image": "/assets/images/cover4.jpg",
    "description": "My intention is for this to be a place where I post anything that interests my geeky mind. I may not update it often, and you may not find it that interesting.. You've been forewarned.
"
}
  </script>

  <meta name="generator" content="Jekyll 3.x">
  <link rel="home" type="application/rss+xml" title="/dev/alias – Hack. Dev. Transcend." href="/feed.xml">


</head>
<body class="post-template nav-closed">

    <div class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="#" class="nav-close">
        <span class="hidden">Close</span>
    </a>
    <ul>
        
            <li class="nav-home " role="presentation">
                <a href="/">Home</a>
            </li>
        
            <li class="nav-about " role="presentation">
                <a href="/about">About</a>
            </li>
        
            <li class="nav-dev " role="presentation">
                <a href="/dev">Development</a>
            </li>
        
            <li class="nav-sec " role="presentation">
                <a href="/sec">Security</a>
            </li>
        
            <li class="nav-go-deeper " role="presentation">
                <a href="/go-deeper/">Go Deeper...</a>
            </li>
        
    </ul>
    <a class="subscribe-button" href="/feed.xml"><i class="fa fa-rss"></i> Subscribe</a>
</div>
<span class="nav-cover"></span>

    <div class="site-wrapper">
        <!-- [[! Everything else gets inserted here ]] -->
        <!-- Layout: Post -->
<!-- Template: header -->




<header class="main-header
               
                    " style="background-image: url(/assets/images/cover4.jpg)
                ">
    <nav class="main-nav overlay clearfix">
        
          <a class="blog-logo" href="/"><img src="/assets/images/devalias-prompt.png" alt="Blog Logo"></a>
        
        
            <a class="menu-button" href="#"><i class="fa fa-bars"></i> <span class="word">Menu</span></a>
        
    </nav>

    
        
            <div class="vertical">
                <div class="main-header-content inner">
                    
                        <h1 class="page-title">Plesk - Adding wget/tar/gzip/chmod/php/curl/clear to a chrooted SSH</h1>
                    
                    
                </div>
            </div>
        
    

    
</header>
<!-- /Template: header -->


<main id="content" class="content" role="main">
    <article class="post ">
        <header class="post-header">
            <!-- <h1 class="post-title">Plesk - Adding wget/tar/gzip/chmod/php/curl/clear to a chrooted SSH</h1> -->
            <section class="post-meta">
    
        <img class="author-thumb" src="/assets/images/authors/devalias.png" alt="Author image" nopin="nopin">
    
    
        <a href="/author/devalias">Glenn 'devalias' Grant</a>
    
    |
    <time class="post-date" datetime="2013-09-19">19 Sep 2013</time>
    |
    4 minutes to read
    <!-- [[tags prefix=" on "]] -->
     
        |
        
            <a href="/tag/plesk">#plesk</a>,
        
            <a href="/tag/chroot">#chroot</a>,
        
            <a href="/tag/ssh">#ssh</a>,
        
            <a href="/tag/wget">#wget</a>,
        
            <a href="/tag/tar">#tar</a>,
        
            <a href="/tag/gzip">#gzip</a>,
        
            <a href="/tag/chmod">#chmod</a>,
        
            <a href="/tag/libssl.so.6">#libssl.so.6</a>,
        
            <a href="/tag/chrootmng">#chrootmng</a>,
        
            <a href="/tag/ldd">#ldd</a>,
        
            <a href="/tag/chroot_update.sh">#chroot_update.sh</a>,
        
            <a href="/tag/php">#php</a>,
        
            <a href="/tag/curl">#curl</a>,
        
            <a href="/tag/clear">#clear</a>,
        
            <a href="/tag/tldr">#tldr</a>
        
    
    
        | 
        <a href="http://devalias.tumblr.com/post/61566531090/plesk-adding-wget-tar-gzip-chmod-php-curl-clear-to-a-chr" title="Imported from original post on Tumblr" target="_blank"><i class="fa fa-tumblr-square"></i></a>
    
</section>
        </header>

        <section class="post-content">
            <p>(<strong>tl;dr</strong> How to setup wget, tar, gzip, chmod, php and curl in a chrooted environment for Plesk.)</p>

<p>So those of you that have been around for a while (or read back through the archive) will know that a while ago I posted <a href="/post/15535429513/plesk-adding-programs-to-a-chrooted-ssh">Plesk - Adding programs to a chrooted SSH</a>, giving a few hints and tips about configuring a chrooted environment in Plesk.</p>

<p>Today I bring you a few more little tidbits to help you out with adding <em>wget, tar, gzip and chmod</em> to your Plesk chroot'd environment. I followed these steps recently in helping a client get their new site up and running.</p>

<p><strong>Edit:</strong> So it turns out Parallels has an <a href="http://kb.odin.com/en/115842">updated script called chroot_update.sh</a> which makes this even easier again (yay for easy!) So I will show you how do use that for PHP and curl (at the bottom).</p>

<h2>Using chroot_update.sh</h2>

<p>Adding programs to chroot is made MUCH easier now with the <a href="http://kb.odin.com/en/115842">chroot_update.sh</a> script from Parallels.</p>

<p>To setup/update the initial chroot environment</p>
<div class="highlight"><pre><code class="language-" data-lang="">./chroot_update.sh --update
</code></pre></div>
<p>To add a new program (and it's dependent shared libraries)</p>
<div class="highlight"><pre><code class="language-" data-lang="">./chroot_update.sh --add /path/to/programname
</code></pre></div>
<p>or</p>
<div class="highlight"><pre><code class="language-" data-lang="">./chroot_update.sh --add `which programname`
</code></pre></div>
<p>Then to update each sites individual chroot folder</p>
<div class="highlight"><pre><code class="language-" data-lang="">./chroot_update.sh --apply all
</code></pre></div>
<p>If you find there are some missing shared objects, figure out which ones are missing using ldd and copy them in to the chroot folder</p>
<div class="highlight"><pre><code class="language-" data-lang="">ldd /path/to/programname
cp /path/to/missingobject chroot/path/to/missingobject
./chroot_update.sh --apply all
</code></pre></div>
<h2>Wget</h2>

<p><a href="https://www.gnu.org/software/wget/">Wget</a> is an awesome little program for downloading files off the net. For anyone who has ever setup an install of some 3rd party program and had to individually upload each and every file, this is a lifesaver!</p>

<p>To find out where the wget executable is</p>
<div class="highlight"><pre><code class="language-" data-lang="">which wget
</code></pre></div>
<p>To check if it has any dependancies</p>
<div class="highlight"><pre><code class="language-" data-lang="">ldd `which wget`
</code></pre></div>
<p>This will probably give you a whole list of things, but it seems the only one we really need to worry about (at least that I did) was <em>libssl.so.6</em>. So we copy both it and the executable to the chroot template folder</p>
<div class="highlight"><pre><code class="language-" data-lang="">cp `which wget` /var/www/vhosts/chroot/bin
cp /lib64/libssl.so.6 /var/www/vhosts/chroot/lib64
</code></pre></div>
<p>And it's done! To update any sites already generated, checkout the <a href="/post/15535429513/plesk-adding-programs-to-a-chrooted-ssh">original article</a></p>

<h2>Tar</h2>

<p><a href="https://www.gnu.org/software/tar/">Tar</a> is the defacto standard for archiving/unarchiving files on *nix, so.. it's pretty useful.</p>

<p>To find out where the tar executable is</p>
<div class="highlight"><pre><code class="language-" data-lang="">which tar
</code></pre></div>
<p>To check if it has any dependancies</p>
<div class="highlight"><pre><code class="language-" data-lang="">ldd `which tar`
</code></pre></div>
<p>In my case, nothing needed here, so let's just copy the executable</p>
<div class="highlight"><pre><code class="language-" data-lang="">cp `which tar` /var/www/vhosts/chroot/bin
</code></pre></div>
<p>Done! Same as before, to update any sites already generated, checkout the <a href="/post/15535429513/plesk-adding-programs-to-a-chrooted-ssh">original article</a></p>

<h2>Gzip</h2>

<p><a href="http://www.gzip.org/">Gzip</a> let's you open gzip compressed files (funnily enough) It's also what <code>tar</code> calls when you tell it to extract a <code>.tar.gz</code> file.</p>

<p>To find out where the gzip executable is</p>
<div class="highlight"><pre><code class="language-" data-lang="">which gzip
</code></pre></div>
<p>To check if it has any dependancies</p>
<div class="highlight"><pre><code class="language-" data-lang="">ldd `which gzip`
</code></pre></div>
<p>In my case, nothing needed here, so let's just copy the executable</p>
<div class="highlight"><pre><code class="language-" data-lang="">cp `which gzip` /var/www/vhosts/chroot/bin
</code></pre></div>
<p>Done! Same as before, to update any sites already generated, checkout the <a href="/post/15535429513/plesk-adding-programs-to-a-chrooted-ssh">original article</a></p>

<h2>Chmod</h2>

<p><a href="https://en.wikipedia.org/wiki/Chmod">Chmod</a> let's you change permissions on files, kinda useful to be able to do.</p>

<p>To find out where the chmod executable is</p>
<div class="highlight"><pre><code class="language-" data-lang="">which chmod
</code></pre></div>
<p>To check if it has any dependancies</p>
<div class="highlight"><pre><code class="language-" data-lang="">ldd `which chmod`
</code></pre></div>
<p>In my case, nothing needed here, so let's just copy the executable</p>
<div class="highlight"><pre><code class="language-" data-lang="">cp `which chmod` /var/www/vhosts/chroot/bin
</code></pre></div>
<p>Done! Same as before, to update any sites already generated, checkout the <a href="/post/15535429513/plesk-adding-programs-to-a-chrooted-ssh">original article</a></p>

<h2>PHP</h2>

<p>Sticking to the <code>chroot_update.sh</code> method, installing php is easier than it would otherwise be, but there are still quite a few manual steps due to the dependencies of some of the shared libraries.</p>
<div class="highlight"><pre><code class="language-" data-lang="">./chroot_update.sh --add `which php`
cp -R /usr/lib64/php chroot/usr/lib64
./chroot_update.sh --add /usr/lib64/php/modules/gd.so
./chroot_update.sh --add /usr/lib64/php/modules/imap.so
./chroot_update.sh --add /usr/lib64/php/modules/mysql.so
./chroot_update.sh --add /usr/lib64/php/modules/pdo_mysql.so
./chroot_update.sh --add /usr/lib64/php/modules/pdo_sqlite.so
./chroot_update.sh --add /usr/lib64/php/modules/xsl.so
cp -R /usr/lib64/mysql/ chroot/usr/lib64
cp -R /etc/php.d chroot/etc
cp /etc/localtime chroot/etc/
cp -R /usr/share/zoneinfo chroot/usr/share/
./chroot_update.sh --apply all
``

Your mileage my vary depending on what modules you have installed, but the method is the same as above for other files. You may need to play around with some php.ini type settings to get things working, but it should be relatively straightforward.

## Curl

Sticking to the `chroot_update.sh` method, installing curl is really simple

</code></pre></div>
<p>./chroot<em>update.sh --add <code>which curl</code>
./chroot</em>update.sh --apply all
```</p>

<h2>Clear</h2>

<p>Sticking to the <code>chroot_update.sh</code> method, installing clear is really simple</p>
<div class="highlight"><pre><code class="language-" data-lang="">./chroot_update.sh --add `which clear`
./chroot_update.sh --apply all
</code></pre></div>
        </section>

        <footer class="post-footer">

            <!-- #author-->

            
	<figure class="author-image">
	    <a class="img" href="/author/devalias" style="background-image: url(/assets/images/authors/devalias.png)"><span class="hidden">devalias's Picture</span></a>
	</figure>


            <section class="author">
                <h4>
                    
                        <a href="/author/devalias">Glenn 'devalias' Grant</a>
                    
                </h4>
                
                
                    <p> Glenn is a full-stack, polyglot developer with an acute interest in the offensive side of security.
</p>
                
                <div class="author-meta">
    
        <span class="author-location">
            <i class="fa fa-location-arrow"></i>
            Australia
        </span>
    
    
        <span class="author-link">
            <a href="http://www.devalias.net/">
                <i class="fa fa-link"></i>
                devalias.net
            </a>
        </span>
    
    
</div>
                <div class="author-social">
    <a href="/author/devalias/rss.xml" title="RSS Feed"><i class="fa fa-rss fa-1x"></i></a>
    
        <a href="https://twitter.com/_devalias" title="Twitter" target="_blank"><i class="fa fa-twitter-square fa-1x"></i></a>
    
    
        <a href="https://www.linkedin.com/in/glenndevaliasgrant" title="LinkedIn" target="_blank"><i class="fa fa-linkedin-square fa-1x"></i></a>
    
    
    
    
        <a href="https://github.com/alias1" title="Github" target="_blank"><i class="fa fa-github-square fa-1x"></i></a>
    
    
        <a href="https://www.reddit.com/user/_devalias" title="Reddit" target="_blank"><i class="fa fa-reddit-square fa-1x"></i></a>
    
    
        <a href="https://news.ycombinator.com/user?id=alias1" title="Hacker News" target="_blank"><i class="fa fa-hacker-news fa-1x"></i></a>
    
    
        <a href="https://stackoverflow.com/users/1137085/devalias" title="StackOverflow" target="_blank"><i class="fa fa-stack-overflow fa-1x"></i></a>
    
    
        <a href="https://stackexchange.com/users/1156663/devalias" title="StackExchange" target="_blank"><i class="fa fa-stack-exchange fa-1x"></i></a>
    
    
        <a href="https://keybase.io/devalias" title="Keybase" target="_blank"><i class="fa fa-key fa-1x"></i></a>
    
</div>

            </section>

            <!-- /author  -->

            

<section class="share">
    <h4>Share this post</h4>
    <a href="http://twitter.com/share?text=Plesk%20-%20Adding%20wget/tar/gzip/chmod/php/curl/clear%20to%20a%20chrooted%20SSH&amp;url=http://devalias.net/devalias/2013/09/19/plesk-adding-wget-tar-gzip-chmod-php-curl-clear-to-a-chr/" title="Share on Twitter" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;"><i class="fa fa-twitter-square fa-2x"></i></a>
    <a href="https://www.facebook.com/sharer/sharer.php?u=http://devalias.net/devalias/2013/09/19/plesk-adding-wget-tar-gzip-chmod-php-curl-clear-to-a-chr/" title="Share on Facebook" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;"><i class="fa fa-facebook-square fa-2x"></i></a>
    <a href="https://plus.google.com/share?url=http://devalias.net/devalias/2013/09/19/plesk-adding-wget-tar-gzip-chmod-php-curl-clear-to-a-chr/" title="Share on Google+" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;"><i class="fa fa-google-plus-square fa-2x"></i></a>
</section>
            
            

            
            
        </footer>

    </article>

</main>

<aside class="read-next">

    <!-- [[! next_post ]] -->
    
        <a class="read-next-story no-cover" href="/devalias/2013/10/24/loki-python-based-infrastructure-pentesting-tool-arp-hsr/">
            <section class="post">
                <h2>Loki - Python Based Infrastructure Pentesting Tool (ARP, HSRP, OSPF, etc)</h2>
                <p>Loki is a python based infrastructure pentesting tool focussing on layer 3 protocols, dealing with protocols such as: * ARP * HSRP * RIP *...</p>
            </section>
        </a>
    
    <!-- [[! /next_post ]] -->
    <!-- [[! prev_post ]] -->
    
        <a class="read-next-story prev no-cover" href="/devalias/2013/08/29/reversing-powershell-securestring-for-fun-and-profit/">
            <section class="post">
                <h2>Reversing PowerShell 'SecureString' For Fun And Profit</h2>
                <p>Something that I needed to do in an engagement recently and thought it might be useful to you guys. Here's a little function and demonstration...</p>
            </section>
        </a>
    
    <!-- [[! /prev_post ]] -->
</aside>

<!-- /Layout: Post -->


        <footer class="site-footer clearfix">
            <section class="copyright">
                <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png"></a><br><span xmlns:dct="http://purl.org/dc/terms/" property="dct:title">devalias.net</span> by <a xmlns:cc="http://creativecommons.org/ns#" href="http://www.devalias.net/" property="cc:attributionName" rel="cc:attributionURL">Glenn 'devalias' Grant</a> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
            </section>
            <section class="poweredby">
                <div>
                    <strong>Build:</strong> 56850f9
                    <a href="https://github.com/alias1/devalias.net/tree/master/_posts/2013-09-19-plesk-adding-wget-tar-gzip-chmod-php-curl-clear-to-a-chr.md" target="_blank">
                        <i class="fa fa-edit"></i>
                        Edit on GitHub
                    </a>
                </div>
                Proudly published with
                <a href="https://jekyllrb.com/" target="_blank">Jekyll</a>
                using
                <a href="https://github.com/biomadeira/jasper" target="_blank">Jasper</a>
                to
                <a href="https://github.com/" target="_blank">GitHub</a>
            </section>
        </footer>
    </div>
    <!-- [[! Ghost outputs important scripts and data with this tag ]] -->
    <script type="text/javascript" src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
    <!-- [[! The main JavaScript file for Casper ]] -->
    <script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="/assets/js/index.js"></script>
    <script type="text/javascript" src="/assets/js/webmention_io.js"></script>

    <!-- Add Google Analytics  -->
        <!-- Google Analytics Tracking code -->
     <script>
	    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	    ga('create', 'UA-27970144-1', 'auto');
	    ga('send', 'pageview');
     </script>   
</body>
</html>
